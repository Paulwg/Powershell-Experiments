function get-processexplorer{

    $master = Get-WmiObject win32_process
    [System.Collections.ArrayList]$ProcessArray = @()
    [System.Collections.ArrayList]$ProcessArray2 = @()
    #$Process = $null


    ForEach($item in $master){

        $Process= [PSCustomObject]@{

            Name = $item.ProcessName
            ID = $item.ProcessId
            PPID = $item.ParentProcessID
            CMDLine = $item.CommandLine
            Path = $item.path
            
        }

        $Process2= [PSCustomObject]@{

            Name = $item.ProcessName
            ID = $item.ProcessId
            PPID = $item.ParentProcessID
            CMDLine = $item.CommandLine
            Path = $item.path
            
        }
        
        


 

    $ProcessArray.Add(($Process)) | Out-Null
    $ProcessArray2.Add(($Process2)) | Out-Null

    

    $Process | Add-Member -NotePropertyName Childname -NotePropertyValue $ProcessArray2.name

    ForEach($index in $ProcessArray.ID){where-object{$index -eq $ProcessArray.PPID} ; $Process.ChildName=$ProcessArray.name}
    
    #{foreach($index2 in $processarray2){where-object{$_.ID -eq $ProcessArray.PPID};$Process.Childname=$processarray2.name}}

   

    }#end foreach

    Return $ProcessArray

}
#foreach ($elem.PPID in $ProcessArray) { if ($ProcessArray2 -contains $elem.ID) { Write-Host "$elem.name" } }
